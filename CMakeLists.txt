cmake_minimum_required(VERSION 3.19)

if (APPLE)
    message(FATAL_ERROR "You're currently working on an Apple machine! Apple and their platforms are not supported, if
you wish to help with adding support for apple devices, please make pull request on the main engine repository as well
as on the UVKBuildTool repository(this file is generated by it!) and consider maintaining the apple builds!")
endif()

project(UntitledImGuiFramework)
project(ude-session-logout)

set(CMAKE_CXX_STANDARD 20)

add_subdirectory(Framework/ThirdParty/glfw)
add_subdirectory(Framework/ThirdParty/glew)
set(BUILD_SHARED_LIBS ON)
add_subdirectory(Framework/ThirdParty/yaml-cpp)
set(BUILD_SHARED_LIBS OFF)

option(USE_OS_MODULE "Use the operating system module" ON)
option(USE_AUDIO_MODULE "Use the audio module" OFF)
option(USE_LOCALE_MODULE "Use the locale module" OFF)
option(USE_NETWORKING_MODULE "Use the networking module" OFF)   # Not functional right now
option(USE_PLOTTING_MODULE "Use the plotting module" OFF)
option(USE_UNDO_MODULE "Use the Undo/Redo module" OFF)          # Not functional right now
option(USE_VIDEO_MODULE "Use the video module" OFF)             # Not functional right now

include_directories("Source/" "Framework/ThirdParty/yaml-cpp/include/yaml-cpp" "Framework/"
        "Framework/ThirdParty/imgui/backends/everything/" "Framework/ThirdParty/imgui/backends/Vulkan/" "Framework/ThirdParty/imgui/misc/"
        "Framework/ThirdParty/glfw/include" "Framework/ThirdParty/glew/include" "Framework/ThirdParty/imgui/backends/everything"
        "Framework/ThirdParty/imgui/" "Framework/Core/" "Framework/Renderer/" "Framework/ThirdParty/logger/src/"
        "Framework/ThirdParty/source-libraries/" "Framework/ThirdParty/yaml-cpp/include" "Framework/Modules"
        "/usr/include/dbus-1.0/")


link_directories(ThirdParty/glew/lib)
link_directories(UVKBuildTool/build)

file(GLOB_RECURSE UGUI_SRC "Framework/Core/*.cpp" "Framework/Renderer/*.cpp"
        "Framework/ThirdParty/imgui/backends/everything/*.cpp" "Framework/ThirdParty/imgui/misc/cpp/*.cpp"
        "Framework/ThirdParty/logger/*.cpp" "Framework/ThirdParty/source-libraries/*.cpp"
        "Framework/Modules/Audio/src/*.cpp" "Framework/Modules/Locale/src/*.cpp" "Source/*.cpp"
        "Framework/Modules/Undo/src/*.cpp" "Framework/Modules/Manager/*.cpp" "Framework/Modules/OS/*.cpp" "Framework/Modules/Modules.hpp")
file(GLOB_RECURSE UGUI_HEAD "Framework/Core/*.hpp" "Framework/Renderer/*.hpp"
        "Framework/ThirdParty/imgui/backends/everything/*.h" "Framework/ThirdParty/imgui/misc/cpp/*.h"
        "Framework/ThirdParty/logger/*.h" "Framework/ThirdParty/source-libraries/*.h"
        "Framework/ThirdParty/source-libraries/*.hpp" "Framework/Modules/Audio/src/*.hpp"
        "Framework/Modules/Locale/src/*.hpp" "Source/*.hpp" "Framework/Modules/Undo/src/*.hpp"
        "Framework/Modules/Manager/*.hpp" "Framework/Modules/OS/*.h" "Framework/Modules/OS/*.hpp")
file(GLOB_RECURSE EXEC_SRC "")

if (USE_PLOTTING_MODULE)
    file(GLOB_RECURSE UGUI_IMPLOT_SRC "Framework/Modules/Plotting/*.cpp")
    file(GLOB_RECURSE UGUI_IMPLOT_HEAD "Framework/Modules/Plotting/*.hpp")
else()
    file(GLOB_RECURSE UGUI_IMPLOT_SRC )
    file(GLOB_RECURSE UGUI_IMPLOT_HEAD )
endif()

add_library(UntitledImGuiFramework SHARED ${UGUI_SRC} ${UGUI_HEAD} Generated/BuildDef.hpp ${UGUI_IMPLOT_SRC} ${UGUI_IMPLOT_HEAD})
add_executable(ude-session-logout Generated/main.cpp ${UGUI_HEAD} ${EXEC_SRC} Generated/BuildDef.hpp ${UGUI_IMPLOT_HEAD})

set_target_properties(UntitledImGuiFramework PROPERTIES LINKER_LANGUAGE CXX)
set_target_properties(ude-session-logout PROPERTIES LINKER_LANGUAGE CXX)

if (USE_AUDIO_MODULE)
    target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_AUDIO_MODULE_ENABLED")
    target_compile_definitions(ude-session-logout PRIVATE "UIMGUI_AUDIO_MODULE_ENABLED")
endif()

if (USE_LOCALE_MODULE)
    target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_LOCALE_MODULE_ENABLED")
    target_compile_definitions(ude-session-logout PRIVATE "UIMGUI_LOCALE_MODULE_ENABLED")
endif()

if (USE_PLOTTING_MODULE)
    target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_PLOTTING_MODULE_ENABLED")
    target_compile_definitions(ude-session-logout PRIVATE "UIMGUI_PLOTTING_MODULE_ENABLED")
endif()

if (USE_UNDO_MODULE)
    target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_UNDO_MODULE_ENABLED")
    target_compile_definitions(ude-session-logout PRIVATE "UIMGUI_UNDO_MODULE_ENABLED")
endif()

if (USE_OS_MODULE)
    target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_OS_MODULE_ENABLED")
    target_compile_definitions(ude-session-logout PRIVATE "UIMGUI_OS_MODULE_ENABLED")
endif()

target_compile_definitions(UntitledImGuiFramework PRIVATE "UIMGUI_COMPILE_LIB" "YAML_CPP_DLL" "UVK_LOG_EXPORT_FROM_LIBRARY" "UVK_LIB_COMPILE" "URLL_USE_FUNCTIONAL")
target_compile_definitions(ude-session-logout PRIVATE "UVK_LOG_EXPORT_FROM_LIBRARY" "URLL_USE_FUNCTIONAL")

if (WIN32)
    target_link_libraries(UntitledImGuiFramework glfw opengl32 libglew_static yaml-cpp)
    target_link_libraries(ude-session-logout UntitledImGuiFramework yaml-cpp)
else()
    target_link_libraries(UntitledImGuiFramework glfw GLEW OpenGL util pthread yaml-cpp dl dbus-1)
    target_link_libraries(ude-session-logout UntitledImGuiFramework yaml-cpp dl)
endif()

